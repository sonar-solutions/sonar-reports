FROM ubuntu:22.04

# Install required dependencies
RUN apt-get update && \
    apt-get install -y \
    libglib2.0-0 \
    libc6 \
    libstdc++6 \
    && rm -rf /var/lib/apt/lists/*

WORKDIR /app

# Copy the binary and config
COPY dist/sonar-reports-linux-x86_64 /app/sonar-reports
COPY migration-config.json /app/

# Make executable
RUN chmod +x /app/sonar-reports

# Test the binary
CMD ["/app/sonar-reports", "full-migrate", "/app/migration-config.json"]
